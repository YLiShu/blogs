<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æµ…è°ˆPromise | é»å­ğŸŒ°ç å¢ƒ</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="favicon.ico">
    <meta name="description" content="åœ¨ä»£ç çš„è¿·å®«ä¸­ç©¿æ¢­ï¼Œä¹¦å†™ç€æ”¹å˜ç”Ÿæ´»çš„æ•°å­—ç¯‡ç« ">
    
    <link rel="preload" href="/blogs/assets/css/0.styles.d9a4f19e.css" as="style"><link rel="preload" href="/blogs/assets/js/app.b10d3b76.js" as="script"><link rel="preload" href="/blogs/assets/js/7.51cf2bb3.js" as="script"><link rel="preload" href="/blogs/assets/js/2.90913472.js" as="script"><link rel="preload" href="/blogs/assets/js/1.c35ebe2c.js" as="script"><link rel="preload" href="/blogs/assets/js/70.66e490da.js" as="script"><link rel="prefetch" href="/blogs/assets/js/10.51f51c0e.js"><link rel="prefetch" href="/blogs/assets/js/11.f1c4e2ce.js"><link rel="prefetch" href="/blogs/assets/js/14.90b34deb.js"><link rel="prefetch" href="/blogs/assets/js/15.cd05d3f7.js"><link rel="prefetch" href="/blogs/assets/js/16.0ca60d78.js"><link rel="prefetch" href="/blogs/assets/js/17.26773bd0.js"><link rel="prefetch" href="/blogs/assets/js/18.21df733a.js"><link rel="prefetch" href="/blogs/assets/js/19.eed3c532.js"><link rel="prefetch" href="/blogs/assets/js/20.4c76e8be.js"><link rel="prefetch" href="/blogs/assets/js/21.f18babb4.js"><link rel="prefetch" href="/blogs/assets/js/22.249f648e.js"><link rel="prefetch" href="/blogs/assets/js/23.cb41f22a.js"><link rel="prefetch" href="/blogs/assets/js/24.c95ba296.js"><link rel="prefetch" href="/blogs/assets/js/25.4a450405.js"><link rel="prefetch" href="/blogs/assets/js/26.b1851237.js"><link rel="prefetch" href="/blogs/assets/js/27.ab146b7f.js"><link rel="prefetch" href="/blogs/assets/js/28.83af5ecf.js"><link rel="prefetch" href="/blogs/assets/js/29.17c1b3c2.js"><link rel="prefetch" href="/blogs/assets/js/3.8ff04919.js"><link rel="prefetch" href="/blogs/assets/js/30.5a702d15.js"><link rel="prefetch" href="/blogs/assets/js/31.9b363f9c.js"><link rel="prefetch" href="/blogs/assets/js/32.df071e6e.js"><link rel="prefetch" href="/blogs/assets/js/33.83f13db0.js"><link rel="prefetch" href="/blogs/assets/js/34.a5e21847.js"><link rel="prefetch" href="/blogs/assets/js/35.caa9411a.js"><link rel="prefetch" href="/blogs/assets/js/36.0997f85f.js"><link rel="prefetch" href="/blogs/assets/js/37.41a69cda.js"><link rel="prefetch" href="/blogs/assets/js/38.11c97fc9.js"><link rel="prefetch" href="/blogs/assets/js/39.c7a91778.js"><link rel="prefetch" href="/blogs/assets/js/4.7ab60d34.js"><link rel="prefetch" href="/blogs/assets/js/40.788bd3bb.js"><link rel="prefetch" href="/blogs/assets/js/41.bfd620d2.js"><link rel="prefetch" href="/blogs/assets/js/42.a93d1dad.js"><link rel="prefetch" href="/blogs/assets/js/43.36e369c4.js"><link rel="prefetch" href="/blogs/assets/js/44.a8c7c1be.js"><link rel="prefetch" href="/blogs/assets/js/45.be0bd724.js"><link rel="prefetch" href="/blogs/assets/js/46.0eead14d.js"><link rel="prefetch" href="/blogs/assets/js/47.9c0b8ec3.js"><link rel="prefetch" href="/blogs/assets/js/48.fedde897.js"><link rel="prefetch" href="/blogs/assets/js/49.658232de.js"><link rel="prefetch" href="/blogs/assets/js/5.07521870.js"><link rel="prefetch" href="/blogs/assets/js/50.e75baace.js"><link rel="prefetch" href="/blogs/assets/js/51.39f09a2a.js"><link rel="prefetch" href="/blogs/assets/js/52.86d8775b.js"><link rel="prefetch" href="/blogs/assets/js/53.2bcea0af.js"><link rel="prefetch" href="/blogs/assets/js/54.80cfc079.js"><link rel="prefetch" href="/blogs/assets/js/55.575fad98.js"><link rel="prefetch" href="/blogs/assets/js/56.a9ac12aa.js"><link rel="prefetch" href="/blogs/assets/js/57.bc25fe73.js"><link rel="prefetch" href="/blogs/assets/js/58.a1f3dfda.js"><link rel="prefetch" href="/blogs/assets/js/59.acfc0f60.js"><link rel="prefetch" href="/blogs/assets/js/6.7070ea7f.js"><link rel="prefetch" href="/blogs/assets/js/60.cfc92fb7.js"><link rel="prefetch" href="/blogs/assets/js/61.566a8f66.js"><link rel="prefetch" href="/blogs/assets/js/62.1c3ab2d6.js"><link rel="prefetch" href="/blogs/assets/js/63.f1df4d25.js"><link rel="prefetch" href="/blogs/assets/js/64.349b7d3b.js"><link rel="prefetch" href="/blogs/assets/js/65.3e277b74.js"><link rel="prefetch" href="/blogs/assets/js/66.f985ae29.js"><link rel="prefetch" href="/blogs/assets/js/67.fecbf0ba.js"><link rel="prefetch" href="/blogs/assets/js/68.1f08c812.js"><link rel="prefetch" href="/blogs/assets/js/69.55f47746.js"><link rel="prefetch" href="/blogs/assets/js/8.8dfb1e90.js"><link rel="prefetch" href="/blogs/assets/js/9.18b271e2.js"><link rel="prefetch" href="/blogs/assets/js/vendors~docsearch.814a0df0.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.d9a4f19e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>é»å­ğŸŒ°ç å¢ƒ</h3> <p class="description" data-v-59e6cb88>åœ¨ä»£ç çš„è¿·å®«ä¸­ç©¿æ¢­ï¼Œä¹¦å†™ç€æ”¹å˜ç”Ÿæ´»çš„æ•°å­—ç¯‡ç« </p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>é»å­</span>
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><img src="/blogs/avatar.jpg" alt="é»å­ğŸŒ°ç å¢ƒ" class="logo"> <span class="site-name">é»å­ğŸŒ°ç å¢ƒ</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/categories/å‰ç«¯/" class="nav-link"><i class="undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/è®¡ç®—æœºç½‘ç»œ/" class="nav-link"><i class="undefined"></i>
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/ç®—æ³•/" class="nav-link"><i class="undefined"></i>
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/å­¦æ ¡è¯¾ç¨‹/" class="nav-link"><i class="undefined"></i>
  å­¦æ ¡è¯¾ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/é¢è¯•/" class="nav-link"><i class="undefined"></i>
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/åç«¯/" class="nav-link"><i class="undefined"></i>
  åç«¯
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      é»å­ğŸŒ°Code
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3206591176245848" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/YLiShu" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/blogs/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/blogs/avatar.jpg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    é»å­
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>32</h3> <h6 data-v-1fad0c41>æ–‡ç« </h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>18</h3> <h6 data-v-1fad0c41>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/blogs/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/categories/å‰ç«¯/" class="nav-link"><i class="undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/è®¡ç®—æœºç½‘ç»œ/" class="nav-link"><i class="undefined"></i>
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/ç®—æ³•/" class="nav-link"><i class="undefined"></i>
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/å­¦æ ¡è¯¾ç¨‹/" class="nav-link"><i class="undefined"></i>
  å­¦æ ¡è¯¾ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/é¢è¯•/" class="nav-link"><i class="undefined"></i>
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/blogs/categories/åç«¯/" class="nav-link"><i class="undefined"></i>
  åç«¯
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      é»å­ğŸŒ°Code
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3206591176245848" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/YLiShu" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/blogs/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>æµ…è°ˆPromise</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>é»å­</span>
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">æµ…è°ˆPromise</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>é»å­</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/11/13</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>JavaScript</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="promiseçš„ç†è§£å’Œä½¿ç”¨"><a href="#promiseçš„ç†è§£å’Œä½¿ç”¨" class="header-anchor">#</a> Promiseçš„ç†è§£å’Œä½¿ç”¨</h1> <h2 id="promiseæ˜¯ä»€ä¹ˆ"><a href="#promiseæ˜¯ä»€ä¹ˆ" class="header-anchor">#</a> Promiseæ˜¯ä»€ä¹ˆï¼Ÿ</h2> <h3 id="ç†è§£"><a href="#ç†è§£" class="header-anchor">#</a> ç†è§£</h3> <ol><li>æŠ½è±¡è¡¨è¾¾ï¼š
<ol><li>Promiseæ˜¯ä¸€é—¨æ–°çš„æŠ€æœ¯ï¼ˆES6è§„èŒƒï¼‰</li> <li>Promiseæ˜¯JSä¸­è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹çš„æ–°è§£å†³æ–¹æ¡ˆï¼ˆæ—§æ–¹æ¡ˆæ˜¯å•çº¯ä½¿ç”¨å›è°ƒå‡½æ•°ï¼‰</li></ol></li> <li>å…·ä½“è¡¨è¾¾ï¼š
<ol><li>ä»è¯­æ³•ä¸Šæ¥è¯´ï¼šPromiseæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°</li> <li>ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼šPromiseå¯¹è±¡ç”¨æ¥å°è£…ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¹¶å¯ä»¥è·å–å…¶æˆåŠŸ/å¤±è´¥çš„ç»“æœå€¼</li></ol></li></ol> <h3 id="å¼‚æ­¥ç¼–ç¨‹"><a href="#å¼‚æ­¥ç¼–ç¨‹" class="header-anchor">#</a> å¼‚æ­¥ç¼–ç¨‹</h3> <ul><li>fs æ–‡ä»¶æ“ä½œ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>æ•°æ®åº“æ“ä½œ</li> <li>AJAX</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/server'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>å®šæ—¶å™¨</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="promiseçš„çŠ¶æ€æ”¹å˜"><a href="#promiseçš„çŠ¶æ€æ”¹å˜" class="header-anchor">#</a> Promiseçš„çŠ¶æ€æ”¹å˜</h3> <p><mark style="background:#FF5582A6;">Promiseå¯¹è±¡çš„çŠ¶æ€</mark>
å®ä¾‹å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼šã€PromiseStateã€‘</p> <ul><li>pending  æœªå†³å®šçš„</li> <li>resolved / fullfilled æˆåŠŸ</li> <li>rejected å¤±è´¥</li></ul> <p><mark style="background:#FF5582A6;">Promiseå¯¹è±¡çš„å€¼</mark>
å®ä¾‹å¯¹è±¡ä¸­çš„å¦ä¸€ä¸ªå±æ€§ï¼šã€PromiseResultã€‘
ä¿å­˜ç€å¯¹è±¡ã€æˆåŠŸ/å¤±è´¥ã€‘çš„ç»“æœ</p> <ul><li>resolve</li> <li>reject</li></ul> <ol><li>pendingå˜ä¸ºresolved</li> <li>pendingå˜ä¸ºrejected</li> <li>è¯´æ˜ï¼š
<ul><li>åªæœ‰è¿™2ç§ï¼Œä¸”ä¸€ä¸ªPromiseå¯¹è±¡åªèƒ½æ”¹å˜ä¸€æ¬¡</li> <li>æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç»“æœæ•°æ®</li> <li>æˆåŠŸçš„ç»“æœæ•°æ®ä¸€èˆ¬ç§°ä¸ºvalueï¼Œå¤±è´¥çš„ç»“æœæ•°æ®ä¸€èˆ¬ç§°ä¸ºreason</li></ul></li></ol> <h3 id="promiseçš„åŸºæœ¬æµç¨‹"><a href="#promiseçš„åŸºæœ¬æµç¨‹" class="header-anchor">#</a> Promiseçš„åŸºæœ¬æµç¨‹</h3> <p><img src="https://gitee.com/yelishu/note/raw/master/noteImgs_2/202307071716527.png" alt="image.png"></p> <h3 id="promiseçš„åŸºæœ¬ä½¿ç”¨"><a href="#promiseçš„åŸºæœ¬ä½¿ç”¨" class="header-anchor">#</a> Promiseçš„åŸºæœ¬ä½¿ç”¨</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å°è£…ä¸€ä¸ªå‡½æ•°sendAJAXå‘é€ GET AJAX è¯·æ±‚</span>
<span class="token comment">// å‚æ•°ï¼šURL</span>
<span class="token comment">// è¿”å›ç»“æœï¼šPromiseå¯¹è±¡</span>

<span class="token keyword">function</span> <span class="token function">sendAJAX</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
		xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">sendAJAX</span><span class="token punctuation">(</span><span class="token string">'https://v.api.aa1.cn/api/api-mima/mima.php?msg=10'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><mark style="background:#FF5582A6;">å¼‚å¸¸ç©¿é€</mark></p> <blockquote><p>å¯ä»¥åœ¨æ¯ä¸ªthen()çš„ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ä¸­è¿›è¡Œerrå¤„ç†ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å¼‚å¸¸ç©¿é€ç‰¹æ€§ï¼Œåˆ°æœ€åç”¨<code>catch</code>å»ç»Ÿä¸€å¤„ç†ï¼Œä¸¤è€…ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå‰è€…ä¼šç”Ÿæ•ˆï¼ˆå› ä¸ºerrå·²ç»å°†å…¶å¤„ç†ï¼Œå°±ä¸ä¼šå¾€ä¸‹ç©¿é€ï¼‰è€Œèµ°ä¸åˆ°åé¢çš„catch</p> <p>åœ¨æ¯ä¸ª.then()ä¸­æˆ‘ä»¬å¯ä»¥å°†æ•°æ®å†æ¬¡ä¼ å‡ºç»™ä¸‹ä¸€ä¸ªthen()</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mineReadFile</span><span class="token punctuation">(</span><span class="token string">'./resource/content.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&quot;2222222&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;è¿™æ˜¯catchçš„&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><mark style="background:#FF5582A6;">util.promisifyæ–¹æ³•</mark></p> <blockquote><p>å¯ä»¥å°†å‡½æ•°ç›´æ¥å˜æˆPromiseçš„å°è£…æ–¹å¼ï¼Œä¸ç”¨å†å»æ‰‹åŠ¨å°è£…</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
util.promisify æ–¹æ³•
*/</span>

<span class="token comment">// å¼•å…¥utilæ¨¡å—</span>
<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> mineReadFile <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span>readFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">mineReadFile</span><span class="token punctuation">(</span><span class="token string">'./resource/content.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨promise"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨promise" class="header-anchor">#</a> ä¸ºä»€ä¹ˆè¦ç”¨Promiseï¼Ÿ</h2> <h3 id="æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»"><a href="#æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»" class="header-anchor">#</a> æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»</h3> <ol><li>æ—§çš„ï¼šå¿…é¡»åœ¨å¯åŠ¨å¼‚æ­¥ä»»åŠ¡å‰æŒ‡å®š</li> <li>Promiseï¼šå¯åŠ¨å¼‚æ­¥ä»»åŠ¡ =&gt; è¿”å›Promiseå¯¹è±¡ =&gt; ç»™Promiseå¯¹è±¡ç»‘å®šå›è°ƒå‡½æ•°ï¼ˆç”šè‡³å¯ä»¥åœ¨å¼‚æ­¥ä»»åŠ¡ç»“æŸåæŒ‡å®š/å¤šä¸ªï¼‰</li></ol> <h3 id="æ”¯æŒé“¾å¼è°ƒç”¨-å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜"><a href="#æ”¯æŒé“¾å¼è°ƒç”¨-å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜" class="header-anchor">#</a> æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œå¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜</h3> <ol><li>ä»€ä¹ˆæ˜¯å›è°ƒåœ°ç‹±ï¼Ÿ
<ul><li>å›è°ƒå‡½æ•°åµŒå¥—è°ƒç”¨ï¼Œå¤–éƒ¨å›è°ƒå‡½æ•°å¼‚æ­¥æ‰§è¡Œçš„ç»“æœæ˜¯åµŒå¥—çš„å›è°ƒæ‰§è¡Œçš„æ¡ä»¶
<img src="https://gitee.com/yelishu/note/raw/master/noteImgs_2/202307071732955.png" alt="image.png"></li></ul></li> <li>å›è°ƒåœ°ç‹±çš„ç‰¹ç‚¹ï¼Ÿ
<ul><li>ä¸ä¾¿äºé˜…è¯»</li> <li>ä¸ä¾¿äºå¼‚å¸¸å¤„ç†</li></ul></li> <li>è§£å†³æ–¹æ¡ˆ
<ul><li>Promiseï¼šæ”¯æŒé“¾å¼è°ƒç”¨ï¼Œèƒ½å¤Ÿè§£å†³å›è°ƒåœ°ç‹±é—®é¢˜</li> <li>Async/Awaitï¼šè¯­æ³•ç³–ï¼Œéšè—Promiseï¼Œä½¿å¼‚æ­¥é€»è¾‘çœ‹èµ·æ¥åƒåŒæ­¥é€»è¾‘ï¼Œå¯ä»¥æ›´å¥½åœ°è§£å†³å›è°ƒåœ°ç‹±</li> <li>Generatorï¼šé€šè¿‡yieldå¯ä»¥æš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œä¸ºå¼‚æ­¥ç¼–ç¨‹é€šè¿‡äº†å¯èƒ½</li></ul></li></ol> <h2 id="å¦‚ä½•ä½¿ç”¨promise"><a href="#å¦‚ä½•ä½¿ç”¨promise" class="header-anchor">#</a> å¦‚ä½•ä½¿ç”¨Promiseï¼Ÿ</h2> <h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <ol><li><p>Promiseæ„é€ å‡½æ•°ï¼šPromise (executor) {}</p> <ul><li>executor å‡½æ•°ï¼šæ‰§è¡Œå™¨ (resolve, reject) =&gt; {}</li> <li>resolve å‡½æ•°ï¼šå†…éƒ¨å®šä¹‰æˆåŠŸæ—¶æˆ‘ä»¬è°ƒç”¨çš„å‡½æ•° value =&gt; {}</li> <li>reject å‡½æ•°ï¼šå†…éƒ¨å®šä¹‰å¤±è´¥æ—¶æˆ‘ä»¬è°ƒç”¨çš„å‡½æ•° reason =&gt; {}</li> <li>è¯´æ˜ï¼šexecutor ä¼šåœ¨ Promise å†…éƒ¨ç«‹å³åŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥æ“ä½œåœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œ</li></ul></li> <li><p>Promise.prototype.then æ–¹æ³•ï¼š(onResolved, onRejected) =&gt; {}</p> <ul><li>onResolved å‡½æ•°ï¼šæˆåŠŸçš„å›è°ƒå‡½æ•° (value) =&gt; {}</li> <li>onRejected å‡½æ•°ï¼šå¤±è´¥çš„å›è°ƒå‡½æ•° (reason) =&gt; {}</li> <li>è¯´æ˜ï¼šæŒ‡å®šç”¨äºå¾—åˆ°æˆåŠŸvalueçš„æˆåŠŸå›è°ƒå’Œç”¨äºå¾—åˆ°å¤±è´¥reasonçš„å¤±è´¥å›è°ƒï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡</li></ul></li> <li><p>Promise.prototype.catch æ–¹æ³•ï¼š(onRejected) =&gt; {}</p> <ul><li>onRejected å‡½æ•°ï¼šå¤±è´¥çš„å›è°ƒå‡½æ•° (reason) =&gt; {}</li> <li>è¯´æ˜ï¼šthen() çš„è¯­æ³•ç³–ï¼Œç›¸å¯¹äºï¼šthen(undefined, OnRejected)</li> <li>å¼‚å¸¸ç©¿é€ä½¿ç”¨ï¼šå½“è¿è¡Œåˆ°æœ€åï¼Œæ²¡è¢«å¤„ç†çš„æ‰€æœ‰å¼‚å¸¸é”™è¯¯éƒ½ä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸­</li></ul></li> <li><p>Promise.resolve æ–¹æ³•ï¼š(value) =&gt; {}</p> <ul><li>valueï¼šæˆåŠŸçš„æ•°æ®æˆ– promise å¯¹è±¡</li> <li>è¯´æ˜è¿”å›ä¸€ä¸ªæˆåŠŸ/å¤±è´¥çš„ promise å¯¹è±¡</li></ul></li> <li><p>Promise.reject æ–¹æ³•ï¼š(reason) =&gt; {}</p> <ul><li>reasonï¼šå¤±è´¥çš„åŸå› </li> <li>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªå¤±è´¥çš„ promise å¯¹è±¡</li></ul></li> <li><p>Promise.all æ–¹æ³•ï¼š(promises) =&gt; {}</p> <ul><li>promisesï¼šåŒ…å« n ä¸ª promise çš„æ•°ç»„</li> <li>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ promiseï¼Œåªæœ‰æ‰€æœ‰çš„ promise éƒ½æˆåŠŸæ‰æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªå¤±è´¥äº†å°±ç›´æ¥å¤±è´¥</li></ul></li> <li><p>Promise.race æ–¹æ³•ï¼š(promises) =&gt; {}</p> <ul><li>promisesï¼šåŒ…å« n ä¸ª promise çš„æ•°ç»„</li> <li>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªæ–°çš„promiseï¼Œç¬¬ä¸€ä¸ªå®Œæˆçš„ promise çš„ç»“æœçŠ¶æ€å°±æ˜¯æœ€ç»ˆçš„ç»“æœçŠ¶æ€</li> <li>å¦‚p1å»¶æ—¶ï¼Œå¼€å¯äº†å¼‚æ­¥ï¼Œå†…éƒ¨æ­£å¸¸æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥<code>p2 &gt; p3 &gt; p1</code>ï¼Œç»“æœå°±æ˜¯<code>p2</code></li></ul></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> p3 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'On Yeah'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="8"><li>Promise.prototype.finally()
<ul><li><code>finally()</code>æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡ Promise å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œã€‚è¯¥æ–¹æ³•æ˜¯ <code>ES2018</code> å¼•å…¥æ ‡å‡†çš„ã€‚</li></ul></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>promise
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>Â·Â·Â·<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>Â·Â·Â·<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>Â·Â·Â·<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡<code>promise</code>æœ€åçš„çŠ¶æ€ï¼Œåœ¨æ‰§è¡Œå®Œ<code>then</code>æˆ–<code>catch</code>æŒ‡å®šçš„å›è°ƒå‡½æ•°ä»¥åï¼Œéƒ½ä¼šæ‰§è¡Œ<code>finally</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p> <ul><li><p><code>finally</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œ</p></li> <li><p>è¿™æ„å‘³ç€æ²¡æœ‰åŠæ³•çŸ¥é“ï¼Œå‰é¢çš„ Promise çŠ¶æ€åˆ°åº•æ˜¯<code>fulfilled</code>è¿˜æ˜¯<code>rejected</code>ã€‚</p></li> <li><p>è¿™è¡¨æ˜ï¼Œ<code>finally</code>æ–¹æ³•é‡Œé¢çš„æ“ä½œï¼Œåº”è¯¥æ˜¯ä¸çŠ¶æ€æ— å…³çš„ï¼Œä¸ä¾èµ–äº Promise çš„æ‰§è¡Œç»“æœ</p></li> <li><p><code>finally</code>æœ¬è´¨ä¸Šæ˜¯<code>then</code>æ–¹æ³•çš„ç‰¹ä¾‹</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>promise
<span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç­‰åŒäº</span>
promise
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
	<span class="token parameter">result</span> <span class="token operator">=&gt;</span>  result <span class="token punctuation">,</span>
	<span class="token parameter">error</span> <span class="token operator">=&gt;</span>  <span class="token keyword">throw</span> error
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸ä½¿ç”¨<code>finally</code>æ–¹æ³•ï¼ŒåŒæ ·çš„è¯­å¥éœ€è¦ä¸ºæˆåŠŸå’Œå¤±è´¥ä¸¤ç§æƒ…å†µå„å†™ä¸€æ¬¡ã€‚æœ‰äº†<code>finally</code>æ–¹æ³•ï¼Œåˆ™åªéœ€è¦å†™ä¸€æ¬¡ã€‚</p> <ol start="9"><li>Promise.allSettled()
<ul><li><code>Promise.allSettled()</code>æ–¹æ³•æ¥å—ä¸€ç»„ Promise å®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚</li> <li><strong>åªæœ‰ç­‰åˆ°æ‰€æœ‰è¿™äº›å‚æ•°å®ä¾‹éƒ½è¿”å›ç»“æœ</strong>ï¼Œä¸ç®¡æ˜¯<code>fulfilled</code>è¿˜æ˜¯<code>rejected</code>ï¼ŒåŒ…è£…å®ä¾‹æ‰ä¼šç»“æŸã€‚</li> <li>è¯¥æ–¹æ³•ç”± <a href="https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposal-promise-allSettled" target="_blank" rel="noopener noreferrer">ES2020<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å¼•å…¥ã€‚</li></ul></li></ol> <p><mark style="background:#FF5582A6;">ä¸¾ä¸ªç®€å•çš„ğŸŒ°</mark></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://gitee.com/hongjilin'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://github.com/Hongjilin'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./hong.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//è¯·æ±‚å‰å°† loading æ”¹ä¸ºtrue ; é¡µé¢å‡ºç°æ»šåŠ¨åŠ è½½å›¾æ ‡è’™å±‚</span>
<span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">;</span>
loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ä¸Šé¢ä»£ç å¯¹æœåŠ¡å™¨å‘å‡ºä¸‰ä¸ªè¯·æ±‚ï¼Œç­‰åˆ°ä¸‰ä¸ªè¯·æ±‚éƒ½ç»“æŸï¼Œä¸ç®¡è¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼ŒåŠ è½½çš„æ»šåŠ¨å›¾æ ‡å°±ä¼šæ¶ˆå¤±ã€‚</p></blockquote> <ul><li>è¯¥æ–¹æ³•è¿”å›çš„æ–°çš„ Promise å®ä¾‹ï¼Œä¸€æ—¦ç»“æŸï¼ŒçŠ¶æ€æ€»æ˜¯<code>fulfilled</code>ï¼Œä¸ä¼šå˜æˆ<code>rejected</code></li></ul> <blockquote><p>è¯¥æ–¹æ³•è¿”å›çš„æ–°çš„ Promise å®ä¾‹ï¼Œä¸€æ—¦ç»“æŸï¼ŒçŠ¶æ€æ€»æ˜¯<code>fulfilled</code>ï¼Œä¸ä¼šå˜æˆ<code>rejected</code>ã€‚çŠ¶æ€å˜æˆ<code>fulfilled</code>åï¼ŒPromise çš„ç›‘å¬å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜å¯¹åº”ä¸€ä¸ªä¼ å…¥<code>Promise.allSettled()</code>çš„ Promise å®ä¾‹ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> resolved <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'è¿”å›æˆåŠŸçŠ¶æ€çš„promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> rejected <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'è¿”å›å¤±è´¥çŠ¶æ€çš„promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> allSettledPromise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span>resolved<span class="token punctuation">,</span> rejected<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Promise.allSettled å¾—åˆ°çš„æ–°å®ä¾‹çŠ¶æ€åªä¼šæ˜¯ `fulfilled`</span>
allSettledPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ³¨æ„,è¿™æ˜¯ `fulfilled` çš„å›è°ƒå‡½æ•°,åªæœ‰å…¶çŠ¶æ€ä¸ºæˆåŠŸæ‰èƒ½è¿›åˆ°è¿™é‡Œ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
[
  { &quot;status&quot;: &quot;fulfilled&quot;, &quot;value&quot;: &quot;è¿”å›æˆåŠŸçŠ¶æ€çš„promise&quot; },
  { &quot;status&quot;: &quot;rejected&quot;, &quot;reason&quot;: &quot;è¿”å›å¤±è´¥çŠ¶æ€çš„promise&quot; }
]
*/</span>
</code></pre></div><ul><li><code>Promise.allSettled()</code>çš„è¿”å›å€¼<code>allSettledPromise</code>ï¼ŒçŠ¶æ€åªå¯èƒ½å˜æˆ<code>fulfilled</code>(æ³¨æ„,æ˜¯ <strong>allSettledPromise</strong> çš„çŠ¶æ€,è€Œä¸æ˜¯å†…éƒ¨çš„promiseå®ä¾‹)</li> <li>å®ƒçš„ç›‘å¬å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯æ•°ç»„<code>results</code>ã€‚è¯¥æ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹åº”çš„æ˜¯ä¼ å…¥<code>Promise.allSettled()</code>çš„ Promise å®ä¾‹ã€‚</li> <li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰<code>status</code>å±æ€§ï¼Œè¯¥å±æ€§çš„å€¼åªå¯èƒ½æ˜¯å­—ç¬¦ä¸²<code>fulfilled</code>æˆ–å­—ç¬¦ä¸²<code>rejected</code>ã€‚</li> <li><code>fulfilled</code>æ—¶ï¼Œå¯¹è±¡æœ‰<code>value</code>å±æ€§ï¼Œ<code>rejected</code>æ—¶æœ‰<code>reason</code>å±æ€§ï¼Œå¯¹åº”ä¸¤ç§çŠ¶æ€çš„è¿”å›å€¼ã€‚</li></ul> <h3 id="promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜"><a href="#promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜" class="header-anchor">#</a> Promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜</h3> <ol><li><p>å¦‚ä½•æ”¹å˜Promiseçš„çŠ¶æ€ï¼Ÿ</p> <ul><li>resolve(value)ï¼šå¦‚æœå½“å‰æ˜¯pendingå°±ä¼šå˜æˆresolved</li> <li>reject(reason)ï¼šå¦‚æœå½“å‰æ˜¯pendingå°±ä¼šå˜æˆrejected</li> <li>æŠ›å‡ºå¼‚å¸¸ï¼šå¦‚æœå½“å‰æ˜¯pendingå°±ä¼šå˜æˆrejected</li></ul></li> <li><p>ä¸€ä¸ªPromiseæŒ‡å®šå¤šä¸ªæˆåŠŸ/å¤±è´¥å›è°ƒå‡½æ•°ï¼Œéƒ½ä¼šè°ƒç”¨å—ï¼Ÿ</p> <ul><li>å½“Promiseæ”¹å˜ä¸ºå¯¹åº”çŠ¶æ€æ—¶éƒ½ä¼šè°ƒç”¨</li></ul></li> <li><p>æ”¹å˜PromiseçŠ¶æ€å’ŒæŒ‡å®šå›è°ƒå‡½æ•°è°å…ˆè°åï¼Ÿ</p> <ul><li>éƒ½æœ‰å¯èƒ½ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ˜¯å…ˆæŒ‡å®šå›è°ƒå†æ”¹å˜çŠ¶æ€ï¼ˆ<code>å¼‚æ­¥</code>ï¼‰ï¼š
å…ˆæŒ‡å®šå›è°ƒ --&gt; å†æ”¹å˜çŠ¶æ€ --&gt; æ”¹å˜çŠ¶æ€åæ‰è¿›å…¥å¼‚æ­¥é˜Ÿåˆ—æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œ
ä½†ä¹Ÿå¯ä»¥å…ˆæ”¹å˜çŠ¶æ€å†æŒ‡å®šå›è°ƒï¼ˆ<code>åŒæ­¥</code>ï¼‰ï¼š
æ”¹å˜çŠ¶æ€ --&gt; æŒ‡å®šå›è°ƒ <code>å¹¶é©¬ä¸Šæ‰§è¡Œ</code>å›è°ƒ</li> <li>å¦‚ä½•å…ˆæ”¹å˜çŠ¶æ€å†æŒ‡å®šå›è°ƒï¼Ÿ
<ul><li>åœ¨æ‰§è¡Œå™¨ä¸­ç›´æ¥è°ƒç”¨resolve() / reject()ï¼Œå³ä¸ä½¿ç”¨å®šæ—¶å™¨ç­‰æ–¹æ³•,æ‰§è¡Œå™¨å†…ç›´æ¥åŒæ­¥æ“ä½œ</li> <li>å»¶è¿Ÿæ›´é•¿æ—¶é—´æ‰è°ƒç”¨then()ï¼Œå³åœ¨<code>.then()</code>è¿™ä¸ªæ–¹æ³•å¤–å†åŒ…ä¸€å±‚ä¾‹å¦‚å»¶æ—¶å™¨è¿™ç§æ–¹æ³•</li></ul></li> <li>ä»€ä¹ˆæ—¶å€™æ‰èƒ½å¾—åˆ°æ•°æ®ï¼Ÿ
<ul><li>å¦‚æœå…ˆæŒ‡å®šçš„å›è°ƒï¼Œé‚£å½“çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå›è°ƒå‡½æ•°å°±ä¼šè°ƒç”¨ï¼Œå¾—åˆ°æ•°æ®</li> <li>å¦‚æœå…ˆæ”¹å˜çš„çŠ¶æ€ï¼Œé‚£æŒ‡å®šå›è°ƒæ—¶ï¼Œå›è°ƒå‡½æ•°å°±ä¼šè°ƒç”¨ï¼Œå¾—åˆ°æ•°æ®</li></ul></li></ul></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">//å¼‚æ­¥å†™æ³•,è¿™æ ·å†™ä¼šå…ˆæŒ‡å®šå›è°ƒ,å†æ”¹å˜çŠ¶æ€</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//è¿™æ˜¯åŒæ­¥å†™æ³•,è¿™æ ·å†™ä¼šå…ˆæ”¹å˜çŠ¶æ€,å†æŒ‡å®šå›è°ƒ</span>
	<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li><p>promise.then() è¿”å›çš„æ–° promise çš„ç»“æœçŠ¶æ€ç”±ä»€ä¹ˆå†³å®šï¼Ÿ</p> <ul><li>ç®€å•è¡¨è¾¾å¼ï¼šç”± then() æŒ‡å®šçš„å›è°ƒå‡½æ•°æ‰§è¡Œçš„ç»“æœå†³å®š</li> <li>è¯¦ç»†è¡¨è¾¾å¼ï¼š
<ul><li>å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œæ–° promise å˜ä¸º rejectedï¼Œreason ä¸ºæŠ›å‡ºçš„å¼‚å¸¸</li> <li>å¦‚æœè¿”å›çš„æ˜¯é promise çš„ä»»æ„å€¼ï¼Œæ–° promise å˜ä¸º resolvedï¼Œvalue ä¸ºè¿”å›çš„å€¼</li> <li>å¦‚æœè¿”å›çš„æ˜¯å¦ä¸€ä¸ªæ–° promiseï¼Œæ­¤ promise çš„ç»“æœå°±ä¼šå˜æˆæ–° promise çš„ç»“æœ</li></ul></li></ul></li> <li><p>promise å¦‚ä½•ä¸²è”å¤šä¸ªæ“ä½œä»»åŠ¡ï¼Ÿ</p> <ul><li>promise çš„ then() è¿”å›ä¸€ä¸ªæ–°çš„ promiseï¼Œå¯ä»¥å¼€æˆ then() çš„é“¾å¼è°ƒç”¨</li> <li>é€šè¿‡ then çš„é“¾å¼è°ƒç”¨ä¸²è”å¤šä¸ªåŒæ­¥/å¼‚æ­¥ä»»åŠ¡</li></ul></li> <li><p>promise å¼‚å¸¸ç©¿é€ï¼Ÿ</p> <ul><li>å½“ä½¿ç”¨ promise çš„ then é“¾å¼è°ƒç”¨æ—¶ï¼Œå¯ä»¥åœ¨æœ€åæŒ‡å®šå¤±è´¥çš„å›è°ƒ</li> <li>å‰é¢ä»»ä½•æ“ä½œå‡ºç°äº†å¼‚å¸¸ï¼Œéƒ½ä¼šä¼ åˆ°æœ€åå¤±è´¥çš„å›è°ƒä¸­å¤„ç†</li></ul></li> <li><p>ä¸­æ–­ promise é“¾ï¼Ÿ</p> <ul><li>å½“ä½¿ç”¨ promise çš„ then é“¾å¼è°ƒç”¨æ—¶ï¼Œåœ¨ä¸­é—´ä¸­æ–­ï¼Œä¸å†è°ƒç”¨åé¢çš„å›è°ƒå‡½æ•°</li> <li>åŠæ³•ï¼šåœ¨å›è°ƒå‡½æ•°ä¸­è¿”å›ä¸€ä¸ª pending çŠ¶æ€çš„ promise å¯¹è±¡</li></ul></li></ol> <h3 id="promiseçš„å®é™…åº”ç”¨"><a href="#promiseçš„å®é™…åº”ç”¨" class="header-anchor">#</a> Promiseçš„å®é™…åº”ç”¨</h3> <h4 id="åŠ è½½å›¾ç‰‡"><a href="#åŠ è½½å›¾ç‰‡" class="header-anchor">#</a> åŠ è½½å›¾ç‰‡</h4> <p>æˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡çš„åŠ è½½å†™æˆä¸€ä¸ª<code>Promise</code>ï¼Œä¸€æ—¦åŠ è½½å®Œæˆï¼Œ<code>Promise</code>çš„çŠ¶æ€å°±å‘ç”Ÿå˜åŒ–ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">preloadImage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   image<span class="token punctuation">.</span>onload  <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
   image<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span>
   image<span class="token punctuation">.</span>src <span class="token operator">=</span> path<span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="generatorå‡½æ•°ä¸promiseçš„ç»“åˆ"><a href="#generatorå‡½æ•°ä¸promiseçš„ç»“åˆ" class="header-anchor">#</a> Generatorå‡½æ•°ä¸Promiseçš„ç»“åˆ</h4> <p>ä½¿ç”¨Generatorå‡½æ•°ç®¡ç†æµç¨‹ï¼Œé‡åˆ°å¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼Œé€šå¸¸è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getFoo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">try</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">run</span> <span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> it <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">function</span> <span class="token function">go</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span> result<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
   <span class="token keyword">return</span> result<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">go</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">go</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token function">go</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢ä»£ç çš„ Generator å‡½æ•°<code>g</code>ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œ<code>getFoo</code>ï¼Œå®ƒè¿”å›çš„å°±æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚å‡½æ•°<code>run</code>ç”¨æ¥å¤„ç†è¿™ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ä¸‹ä¸€ä¸ª<code>next</code>æ–¹æ³•</p> <h3 id="å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡" class="header-anchor">#</a> å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡</h3> <p><mark style="background:#FF5582A6;">Promise æ–°å»ºåå°±ä¼šç«‹å³æ‰§è¡Œ</mark></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'resolved.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Promise</span>
<span class="token comment">// Hi!</span>
<span class="token comment">// resolved //å¯ä»¥å‘ç°,æ˜æ˜thenæ˜¯åœ¨ Hi å‰é¢,å´æœ€åæ‰“å°</span>
</code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise æ–°å»ºåç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥é¦–å…ˆè¾“å‡ºçš„æ˜¯<code>Promise</code>ã€‚ç„¶åï¼Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥<code>resolved</code>æœ€åè¾“å‡ºã€‚</p> <p>å®é™…ä¸Š,è¿™ä¸ªè¿è¡Œç»“æœç›¸å…³çŸ¥è¯†ç‚¹æ˜¯å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ï¼Œå•ç‹¬æ¢³ç†åœ¨ä¸‹æ–¹.è¿™é‡Œå¯ä»¥å…ˆåˆæ­¥ç†è§£ä¸º:</p> <ul><li>JSæ˜¯å•çº¿ç¨‹çš„,è‡³ä¸Šå¾€ä¸‹è¿è¡Œ,åœ¨å£°æ˜ <strong>Promise</strong> æ—¶å®é™…ä¸Šå·²ç»æ‰§è¡Œåˆ°äº†å†…éƒ¨æ–¹æ³•</li> <li>ä¸ºä½• resolve() è¿è¡Œåæ²¡æœ‰ç«‹å³æ‰“å°?
<ul><li>JSä¸­ç”¨æ¥å­˜å‚¨å¾…æ‰§è¡Œå›è°ƒå‡½æ•°çš„é˜Ÿåˆ—åŒ…å«2ä¸ªä¸åŒç‰¹å®šçš„åˆ—é˜Ÿ
<ul><li><code>å®é˜Ÿåˆ—</code>:ç”¨æ¥ä¿å­˜å¾…æ‰§è¡Œçš„å®ä»»åŠ¡(å›è°ƒ),æ¯”å¦‚:<code>å®šæ—¶å™¨</code>å›è°ƒ/ajaxå›è°ƒ/domäº‹ä»¶å›è°ƒ</li> <li><code>å¾®é˜Ÿåˆ—</code>:ç”¨æ¥ä¿å­˜å¾…æ‰§è¡Œçš„å¾®ä»»åŠ¡(å›è°ƒ),æ¯”å¦‚:<code>Promise</code>çš„å›è°ƒ/muntationå›è°ƒ</li></ul></li> <li>JSæ‰§è¡Œæ—¶ä¼šåŒºåˆ«è¿™2ä¸ªé˜Ÿåˆ—:
<ul><li>JSæ‰§è¡Œå¼•æ“é¦–å…ˆå¿…é¡»æ‰§è¡Œæ‰€æœ‰çš„<code>åˆå§‹åŒ–åŒæ­¥ä»»åŠ¡</code>ä»£ç </li> <li>æ¯æ¬¡å‡†å¤‡å–å‡ºç¬¬ä¸€ä¸ª<code>å®ä»»åŠ¡æ‰§è¡Œå‰</code>,éƒ½è¦å°†æ‰€æœ‰çš„<code>å¾®ä»»åŠ¡</code>ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥æ‰§è¡Œ</li></ul></li></ul></li></ul> <h1 id="è‡ªå®šä¹‰promise"><a href="#è‡ªå®šä¹‰promise" class="header-anchor">#</a> è‡ªå®šä¹‰Promise</h1> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Promise</span> <span class="token punctuation">{</span>
	<span class="token comment">// æ„é€ æ–¹æ³•</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">executor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// æ·»åŠ å±æ€§</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>promiseState <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>promiseResult <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		
		<span class="token comment">// ä¿å­˜å®ä¾‹å¯¹è±¡çš„thiså€¼</span>
		<span class="token keyword">const</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		
		<span class="token comment">// resolve å‡½æ•°</span>
		<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// åˆ¤æ–­</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_this<span class="token punctuation">.</span>promiseState <span class="token operator">!==</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
			
			<span class="token comment">// 1. ä¿®æ”¹å¯¹è±¡çŠ¶æ€ï¼ˆpromiseStateï¼‰</span>
			_this<span class="token punctuation">.</span>promiseState <span class="token operator">=</span> <span class="token string">'fulfilled'</span><span class="token punctuation">;</span> <span class="token comment">// resolved</span>
			
			<span class="token comment">// 2. è®¾ç½®å¯¹è±¡ç»“æœå€¼ï¼ˆpromiseResultï¼‰</span>
			_this<span class="token punctuation">.</span>promiseResult <span class="token operator">=</span> data<span class="token punctuation">;</span>
			
			<span class="token comment">// è°ƒç”¨æˆåŠŸçš„å›è°ƒå‡½æ•°</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				_this<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					callback<span class="token punctuation">.</span><span class="token function">onResolved</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// rejectå‡½æ•°</span>
		<span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// åˆ¤æ–­</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_this<span class="token punctuation">.</span>promiseState <span class="token operator">!==</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
			
			<span class="token comment">// 1. ä¿®æ”¹å¯¹è±¡çŠ¶æ€ï¼ˆpromiseStateï¼‰</span>
			_this<span class="token punctuation">.</span>promiseState <span class="token operator">=</span> <span class="token string">'rejected'</span><span class="token punctuation">;</span> <span class="token comment">// rejected</span>
			
			<span class="token comment">// 2. è®¾ç½®å¯¹è±¡ç»“æœå€¼ï¼ˆpromiseResultï¼‰</span>
			_this<span class="token punctuation">.</span>promiseResult <span class="token operator">=</span> data<span class="token punctuation">;</span>
			
			<span class="token comment">// è°ƒç”¨å¤±è´¥çš„å›è°ƒå‡½æ•°</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				_this<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					callback<span class="token punctuation">.</span><span class="token function">onRejected</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token comment">// åŒæ­¥è°ƒç”¨ ã€æ‰§è¡Œå™¨å‡½æ•°ã€‘</span>
				<span class="token function">executor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// ä¿®æ”¹ promise å¯¹è±¡çŠ¶æ€ä¸ºã€å¤±è´¥ã€‘</span>
				<span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// thenæ–¹æ³•å°è£…</span>
	<span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">onResolved<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		
		<span class="token comment">// åˆ¤æ–­å›è°ƒå‡½æ•°å‚æ•°</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> onRejected <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function-variable function">onRejected</span> <span class="token operator">=</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> reason<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// åˆ¤æ–­å›è°ƒå‡½æ•°å‚æ•°</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> onResolved <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function-variable function">onResolved</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> value<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// å°è£…å‡½æ•°</span>
			<span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// è·å–å›è°ƒå‡½æ•°æ‰§è¡Œç»“æœ</span>
					<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">type</span><span class="token punctuation">(</span>_this<span class="token punctuation">.</span>promiseResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// åˆ¤æ–­</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// å¦‚æœæ˜¯ Promise ç±»å‹çš„å¯¹è±¡</span>
						result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
							<span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
							<span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
						<span class="token comment">// ç»“æœçš„å¯¹è±¡çŠ¶æ€ä¸ºã€æˆåŠŸã€‘</span>
						<span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// è°ƒç”¨å›è°ƒå‡½æ•°</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>promiseState <span class="token operator">===</span> <span class="token string">'fulfilled'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">callback</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>promiseState <span class="token operator">===</span> <span class="token string">'rejected'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">callback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// åˆ¤æ–­ pending çŠ¶æ€</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>promiseState <span class="token operator">===</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// ä¿å­˜å›è°ƒå‡½æ•°</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					<span class="token function-variable function">onResolved</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token function">callback</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">onRejected</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token function">callback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// catchæ–¹æ³•</span>
	<span class="token keyword">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// resolveæ–¹æ³•</span>
	<span class="token keyword">static</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// rejectæ–¹æ³•</span>
	<span class="token keyword">static</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// allæ–¹æ³•</span>
	<span class="token keyword">static</span> <span class="token function">all</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				promises<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// å¾—çŸ¥å¯¹è±¡çš„çŠ¶æ€æ˜¯æˆåŠŸ</span>
					<span class="token comment">// æ¯ä¸ªpromiseå¯¹è±¡éƒ½æˆåŠŸ</span>
					cnt<span class="token operator">++</span><span class="token punctuation">;</span>
					res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">===</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// ä¿®æ”¹çŠ¶æ€</span>
						<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// raceæ–¹æ³•</span>
	<span class="token keyword">static</span> <span class="token function">race</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				promises<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// ä¿®æ”¹è¿”å›å¯¹è±¡çš„çŠ¶æ€ä¸ºã€æˆåŠŸã€‘</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// ä¿®æ”¹è¿”å›å¯¹è±¡çš„çŠ¶æ€ä¸ºã€å¤±è´¥ã€‘</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="async-ä¸-await"><a href="#async-ä¸-await" class="header-anchor">#</a> async ä¸ await</h1> <ul><li>romise ==&gt; å¼‚æ­¥</li> <li>await ==&gt; å¼‚æ­¥è½¬åŒæ­¥
<ul><li>await å¯ä»¥ç†è§£ä¸ºæ˜¯ async wait çš„ç®€å†™ã€‚await å¿…é¡»å‡ºç°åœ¨ async å‡½æ•°å†…éƒ¨ï¼Œä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚</li> <li>await åé¢å¯ä»¥è·Ÿä»»ä½•çš„JS è¡¨è¾¾å¼ã€‚è™½ç„¶è¯´ await å¯ä»¥ç­‰å¾ˆå¤šç±»å‹çš„ä¸œè¥¿ï¼Œä½†æ˜¯å®ƒæœ€ä¸»è¦çš„æ„å›¾æ˜¯ç”¨æ¥ç­‰å¾… Promise å¯¹è±¡çš„çŠ¶æ€è¢« resolvedã€‚å¦‚æœawaitçš„æ˜¯ promiseå¯¹è±¡ä¼šé€ æˆå¼‚æ­¥å‡½æ•°åœæ­¢æ‰§è¡Œå¹¶ä¸”ç­‰å¾… promise çš„è§£å†³,å¦‚æœç­‰çš„æ˜¯æ­£å¸¸çš„è¡¨è¾¾å¼åˆ™ç«‹å³æ‰§è¡Œ</li></ul></li> <li>async ==&gt; åŒæ­¥è½¬å¼‚æ­¥
<ul><li>æ–¹æ³•ä½“å†…éƒ¨çš„æŸä¸ªè¡¨è¾¾å¼ä½¿ç”¨awaitä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•ä½“æ‰€å±æ–¹æ³•å¿…é¡»è¦ç”¨asyncä¿®é¥°æ‰€ä»¥ä½¿ç”¨awitæ–¹æ³•ä¼šè‡ªåŠ¨å‡çº§ä¸ºå¼‚æ­¥æ–¹æ³•</li></ul></li></ul> <h2 id="mdnæ–‡æ¡£"><a href="#mdnæ–‡æ¡£" class="header-anchor">#</a> MDNæ–‡æ¡£</h2> <ul><li><a href="https://gitee.com/link?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FStatements%2Fasync_function" target="_blank" rel="noopener noreferrer">async<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://gitee.com/link?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Fawait" target="_blank" rel="noopener noreferrer">await<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="asyncå‡½æ•°"><a href="#asyncå‡½æ•°" class="header-anchor">#</a> asyncå‡½æ•°</h2> <ul><li>å‡½æ•°çš„è¿”å›å€¼ä¸ºpromiseå¯¹è±¡</li> <li>promiseå¯¹è±¡çš„ç»“æœç”±asyncå‡½æ•°æ‰§è¡Œçš„è¿”å›å€¼å†³å®š</li></ul> <h2 id="awaitè¡¨è¾¾å¼"><a href="#awaitè¡¨è¾¾å¼" class="header-anchor">#</a> awaitè¡¨è¾¾å¼</h2> <ul><li>awaitå³ä¾§çš„è¡¨è¾¾å¼ä¸€èˆ¬ä¸ºpromiseå¯¹è±¡ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„å€¼</li> <li>å¦‚æœè¡¨è¾¾å¼æ˜¯promiseå¯¹è±¡ï¼Œawaitè¿”å›çš„æ˜¯promiseæˆåŠŸçš„å€¼</li> <li>å¦‚æœè¡¨è¾¾å¼æ˜¯å…¶ä»–å€¼ï¼Œç›´æ¥å°†æ­¤å€¼ä½œä¸ºawaitçš„è¿”å›å€¼</li></ul> <h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="header-anchor">#</a> æ³¨æ„</h2> <ul><li>awaitå¿…é¡»å†™åœ¨asyncå‡½æ•°ä¸­ï¼Œä½†asyncå‡½æ•°ä¸­å¯ä»¥æ²¡æœ‰await</li> <li>å¦‚æœawaitçš„promiseå¤±è´¥äº†ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦é€šè¿‡<code>try...catch</code>æ•è·å¤„ç†</li></ul> <h1 id="å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡-2"><a href="#å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡-2" class="header-anchor">#</a> å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡</h1> <h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="header-anchor">#</a> è¯´æ˜</h2> <ul><li>åŸç†å›¾
<img src="https://gitee.com/yelishu/note/raw/master/noteImgs_2/202307091148275.png" alt="image.png"></li></ul> <p><mark style="background:#FF5582A6;">è¯´æ˜</mark></p> <ul><li>JSä¸­ç”¨æ¥å­˜å‚¨æ‰§è¡Œå›è°ƒå‡½æ•°çš„é˜Ÿåˆ—åŒ…å«ä¸¤ä¸ªä¸åŒç‰¹ç‚¹çš„é˜Ÿåˆ—
<ul><li><code>å®é˜Ÿåˆ—</code>ï¼šç”¨æ¥ä¿å­˜æ‰§è¡Œçš„å®ä»»åŠ¡ï¼ˆå›è°ƒï¼‰ï¼Œæ¯”å¦‚<span style="color:#ff0000;">å®šæ—¶å™¨å›è°ƒ/AJAXå›è°ƒ/DOMäº‹ä»¶å›è°ƒ</span></li> <li><code>å¾®ä»»åŠ¡</code>ï¼šç”¨æ¥ä¿å­˜å¾…æ‰§è¡Œçš„å¾®ä»»åŠ¡ï¼ˆå›è°ƒï¼‰ï¼Œæ¯”å¦‚<span style="color:#ff0000;">Promiseçš„å›è°ƒ/muntationå›è°ƒ</span></li></ul></li> <li>JSæ‰§è¡Œæ—¶ä¼šåŒºåˆ«è¿™ä¸¤ä¸ªé˜Ÿåˆ—
<ul><li>JSæ‰§è¡Œå¼•æ“é¦–å…ˆå¿…é¡»æ‰§è¡Œæ‰€æœ‰çš„<code>åˆå§‹åŒ–åŒæ­¥ä»»åŠ¡</code>ä»£ç </li> <li>æ¯æ¬¡å‡†å¤‡å–å‡ºç¬¬ä¸€ä¸ª<code>å®ä»»åŠ¡æ‰§è¡Œå‰</code>ï¼Œéƒ½è¦å°†æ‰€æœ‰çš„<code>å¾®ä»»åŠ¡</code>ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥æ‰§è¡Œ</li></ul></li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseæ˜¯ä»€ä¹ˆ" class="sidebar-link reco-side-promiseæ˜¯ä»€ä¹ˆ" data-v-b57cc07c>Promiseæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#ç†è§£" class="sidebar-link reco-side-ç†è§£" data-v-b57cc07c>ç†è§£</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#å¼‚æ­¥ç¼–ç¨‹" class="sidebar-link reco-side-å¼‚æ­¥ç¼–ç¨‹" data-v-b57cc07c>å¼‚æ­¥ç¼–ç¨‹</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseçš„çŠ¶æ€æ”¹å˜" class="sidebar-link reco-side-promiseçš„çŠ¶æ€æ”¹å˜" data-v-b57cc07c>Promiseçš„çŠ¶æ€æ”¹å˜</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseçš„åŸºæœ¬æµç¨‹" class="sidebar-link reco-side-promiseçš„åŸºæœ¬æµç¨‹" data-v-b57cc07c>Promiseçš„åŸºæœ¬æµç¨‹</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseçš„åŸºæœ¬ä½¿ç”¨" class="sidebar-link reco-side-promiseçš„åŸºæœ¬ä½¿ç”¨" data-v-b57cc07c>Promiseçš„åŸºæœ¬ä½¿ç”¨</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#ä¸ºä»€ä¹ˆè¦ç”¨promise" class="sidebar-link reco-side-ä¸ºä»€ä¹ˆè¦ç”¨promise" data-v-b57cc07c>ä¸ºä»€ä¹ˆè¦ç”¨Promiseï¼Ÿ</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»" class="sidebar-link reco-side-æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»" data-v-b57cc07c>æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´»</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#æ”¯æŒé“¾å¼è°ƒç”¨-å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜" class="sidebar-link reco-side-æ”¯æŒé“¾å¼è°ƒç”¨-å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜" data-v-b57cc07c>æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œå¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#å¦‚ä½•ä½¿ç”¨promise" class="sidebar-link reco-side-å¦‚ä½•ä½¿ç”¨promise" data-v-b57cc07c>å¦‚ä½•ä½¿ç”¨Promiseï¼Ÿ</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#api" class="sidebar-link reco-side-api" data-v-b57cc07c>API</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜" class="sidebar-link reco-side-promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜" data-v-b57cc07c>Promiseçš„å‡ ä¸ªå…³é”®é—®é¢˜</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#promiseçš„å®é™…åº”ç”¨" class="sidebar-link reco-side-promiseçš„å®é™…åº”ç”¨" data-v-b57cc07c>Promiseçš„å®é™…åº”ç”¨</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/blogs/9.html#å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡" class="sidebar-link reco-side-å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡" data-v-b57cc07c>å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#mdnæ–‡æ¡£" class="sidebar-link reco-side-mdnæ–‡æ¡£" data-v-b57cc07c>MDNæ–‡æ¡£</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#asyncå‡½æ•°" class="sidebar-link reco-side-asyncå‡½æ•°" data-v-b57cc07c>asyncå‡½æ•°</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#awaitè¡¨è¾¾å¼" class="sidebar-link reco-side-awaitè¡¨è¾¾å¼" data-v-b57cc07c>awaitè¡¨è¾¾å¼</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#æ³¨æ„" class="sidebar-link reco-side-æ³¨æ„" data-v-b57cc07c>æ³¨æ„</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/blogs/9.html#è¯´æ˜" class="sidebar-link reco-side-è¯´æ˜" data-v-b57cc07c>è¯´æ˜</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:-1;" data-v-248d85d6></canvas></div><canvas id="vuepress-canvas-cursor"></canvas><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://yelishu.gitee.io/blogs/bg.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:20px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://p2.music.126.net/ZvYHj8W72RwrnOJiOGaL9g==/109951163074555333.jpg?param=130y130" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://p2.music.126.net/ZvYHj8W72RwrnOJiOGaL9g==/109951163074555333.jpg?param=130y130);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          æ’­æ”¾å¤±è´¥
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>â€</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>nevva</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/blogs/assets/js/app.b10d3b76.js" defer></script><script src="/blogs/assets/js/7.51cf2bb3.js" defer></script><script src="/blogs/assets/js/2.90913472.js" defer></script><script src="/blogs/assets/js/1.c35ebe2c.js" defer></script><script src="/blogs/assets/js/70.66e490da.js" defer></script>
  </body>
</html>
